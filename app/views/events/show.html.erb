<%= render "shared/header"%>

<section class="event-show"> 
  <div class="title">
    <h1><%= @event.title %></h1>
  </div>
  <div class="body">
    <div class="top-info">
      <div class="image">
        <%= image_tag @event.image.variant(resize:'500x500') %>
      </div>
      <div class="wrapper">
        <div class="place">
          <p class="row">Place: </p>
          <% if user_signed_in? && @event.online == true && @user_events.exists?(user_id: current_user.id) %>
            <p><%= @event.place %></p>
          <% elsif @event.online == false %>
            <p><%= @event.place %></p>
          <% else %>
            <p>This is online event. The link to join shows only for participants</p>
          <% end %>
        </div>
        <div class="time">
          <p class="row">Start Time:  <%= @event.start_time %></p>
          <p class="row">End Time:  <%= @event.end_time %></p>
        </div>
      </div>
    </div>
    <div class="wrapper-bottom">
      <h2>Country</h2>
      <p class="content">
        <%= @event.country.name %>
      </p>
      <h2>Detail</h2>
      <p class="content">
        <%= @event.content %>
      </p>
    </div>
  </div>
</section>
<% if user_signed_in? %>
  <section class="btn-wrapper"> 
    <div class="btn-wrapper-inner-top">
      <% if @user_events.exists?(user_id: current_user.id) %>
        <p class="btn2">You have already joined this event</p>
      <% else %>
        <p class="btn"><%= link_to "Join this event", event_user_events_path(@event), method: :post %></p>
      <% end %>
    </div>
    <% if current_user.id == @event.user_events.first.user_id %>
    <div class="btn-wrapper-inner-bottom">
      <p class="btn"><%= link_to "Edit this event", edit_event_path(@event) %></p>
      <p class="btn"><%= link_to "Delete this event", event_path(@event),method: :delete %></p>
    </div>
    <% end %>
  </section>
<% else %>
  <section class="btn-wrapper"> 
    <div class="btn-wrapper-inner-top">
      <p class="btn"><%= link_to "Join this event", new_user_session_path, method: :post %></p>
    </div>
  </section>
<% end %>

<div class="footer">
  <%= render "shared/footer"%>
<div>